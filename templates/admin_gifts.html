<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ site_name }} - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/theme.css') }}">
</head>
<body>
  <div class="mobile-wrap">

    <div class="top-card">
      <div class="badge-icon">ğŸ› ï¸</div>
      <div style="margin-top:10px;">
        <div class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§</div>
        <div class="page-subtitle">Ø¥Ø¶Ø§ÙØ© / ØªÙØ¹ÙŠÙ„ / Ø­Ø°Ù</div>
      </div>
      <div style="margin-top:10px;">
        <a href="{{ url_for('admin_dashboard') }}" style="color:var(--muted);text-decoration:none;font-weight:800;">â¬… Ø±Ø¬ÙˆØ¹</a>
      </div>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="section">
          {% for cat, msg in messages %}
            <div style="padding:10px;border-radius:14px;margin-bottom:8px;border:1px solid var(--stroke);
              background: {{ 'rgba(34,197,94,.10)' if cat=='ok' else 'rgba(239,68,68,.10)' }};">
              {{ msg }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <div class="section">
      <div class="section-title">Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§</div>

      <div class="quick-item" style="padding:12px;">
        <a href="{{ url_for('admin_gift_new') }}" style="font-weight:900;">â• Ø¥Ø¶Ø§ÙØ© Ù‡Ø¯ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</a>
      </div>

      {% if gifts|length == 0 %}
        <div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‡Ø¯Ø§ÙŠØ§.</div>
      {% endif %}

      {% for g in gifts %}
        <div class="quick-item" style="padding:12px;text-align:right;">
          <div style="display:flex;gap:12px;align-items:center;">
            <div class="gift-thumb">
              {% if g.image_filename %}
                <img src="{{ url_for('static', filename='uploads/' ~ g.image_filename) }}" alt="">
              {% else %}
                <div style="height:100%;display:flex;align-items:center;justify-content:center;opacity:.6;font-size:26px;">ğŸ</div>
              {% endif %}
            </div>

            <div style="flex:1;">
              <div style="font-weight:900;">{{ g.name }}</div>
              <div class="muted small" style="margin-top:4px;">{{ g.points_required }} Ù†Ù‚Ø·Ø©</div>

              <div style="margin-top:10px;display:flex;gap:10px;flex-wrap:wrap;">
                
                <!-- Ø²Ø± Ø§Ù„ØªÙØ¹ÙŠÙ„ -->
                <form method="post" action="{{ url_for('admin_gift_toggle', gift_id=g.id) }}">
                  <button class="btn-yellow" type="submit" style="width:auto;padding:10px 14px;border-radius:14px;">
                    {% if g.is_active == 1 %} ØªØ¹Ø·ÙŠÙ„ {% else %} ØªÙØ¹ÙŠÙ„ {% endif %}
                  </button>
                </form>

                <!-- Ø²Ø± Ø§Ù„Ø­Ø°Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
                <button type="button"
                        onclick="openDeleteModal({{ g.id }}, '{{ g.name }}')"
                        style="width:auto;padding:10px 14px;border-radius:14px;border:1px solid rgba(239,68,68,.3);
                               background:rgba(239,68,68,.12);color:#ffd7d7;font-weight:900;cursor:pointer;">
                  ğŸ—‘ Ø­Ø°Ù
                </button>

              </div>
            </div>
          </div>
        </div>
      {% endfor %}

    </div>

    <div class="section">
      <div class="section-title">Ø§Ù„Ø±Ø§Ø¨Ø­ÙŠÙ†</div>
      <div class="quick-item" style="padding:12px;">
        <a href="{{ url_for('winners') }}" style="font-weight:900;">ğŸ† Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ø±Ø§Ø¨Ø­ÙŠÙ†</a>
      </div>
    </div>

  </div>


  <!-- ========================= -->
  <!-- Popup Ø­Ø°Ù Ø§Ø­ØªØ±Ø§ÙÙŠ -->
  <!-- ========================= -->

  <div id="deleteModal" class="modal">
      <div class="modal-box">
          <h3>ØªØ£ÙƒÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù‡Ø¯ÙŠØ©</h3>
          <p id="deleteText"></p>

          <form id="deleteForm" method="post">
              <button type="submit" class="btn-delete">Ù†Ø¹Ù…ØŒ Ø­Ø°Ù</button>
              <button type="button" class="btn-cancel" onclick="closeDeleteModal()">Ø¥Ù„ØºØ§Ø¡</button>
          </form>
      </div>
  </div>


  <!-- JavaScript -->
  <script>
  function openDeleteModal(id, name){
      document.getElementById("deleteModal").style.display = "block";
      document.getElementById("deleteText").innerText =
          "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù‡Ø¯ÙŠØ©: " + name + " ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø§.";
      document.getElementById("deleteForm").action = "/admin/gifts/" + id + "/delete";
  }

  function closeDeleteModal(){
      document.getElementById("deleteModal").style.display = "none";
  }
  </script>


  <!-- CSS Ù„Ù„Ù†Ø§ÙØ°Ø© -->
  <style>
  .modal{
      display:none;
      position:fixed;
      z-index:999;
      left:0;
      top:0;
      width:100%;
      height:100%;
      background:rgba(0,0,0,0.65);
      backdrop-filter:blur(4px);
  }

  .modal-box{
      background:#111827;
      color:#fff;
      width:420px;
      margin:12% auto;
      padding:25px;
      border-radius:16px;
      text-align:center;
      box-shadow:0 10px 30px rgba(0,0,0,0.5);
      animation:fadeIn .25s ease;
  }

  .btn-delete{
      background:#ef4444;
      color:white;
      border:none;
      padding:10px 18px;
      border-radius:10px;
      cursor:pointer;
      margin-left:10px;
      font-weight:900;
  }

  .btn-cancel{
      background:#374151;
      color:white;
      border:none;
      padding:10px 18px;
      border-radius:10px;
      cursor:pointer;
      font-weight:900;
  }

  @keyframes fadeIn{
      from{transform:scale(.9);opacity:0}
      to{transform:scale(1);opacity:1}
  }
  </style>

</body>
</html>
